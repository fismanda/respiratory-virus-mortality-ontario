# Respiratory Virus Mortality in Ontario, 1993-2024

## Overview

This repository contains data and code for ecological regression analysis of population attributable mortality from respiratory viruses in Ontario, Canada over a 31-year period (1993-2024).

## Citation

**Manuscript:** [Citation will be added upon publication]

**Data and Code Repository:** [![DOI](https://zenodo.org/badge/DOI/[to-be-added].svg)](https://doi.org/[to-be-added])

If you use this data or code, please cite both the manuscript and this repository.

## Study Summary

We estimated the population attributable fraction (PAF) of deaths due to influenza A, influenza B, respiratory syncytial virus (RSV), and SARS-CoV-2 in Ontario using ecological regression with negative binomial models. The analysis spans two distinct periods:

- **Pre-pandemic period (1993-2020):** Influenza A accounted for 1.8% of all deaths (95% CI: 1.4-2.2%)
- **Pandemic period (2020-2024):** SARS-CoV-2 accounted for 6.5% of all deaths (95% CI: 4.5-8.4%), representing a 3.6-fold higher burden than pre-pandemic influenza A

A key methodological finding was that Fourier seasonal adjustment substantially affected mortality estimates for RSV, revealing either paradoxical negative associations (PAR -0.45%) with seasonal adjustment or consistent positive associations (PAR 1.9%) without adjustment across both periods.

## Repository Contents

```
respiratory-virus-mortality-ontario/
├── README.md                    # This file
├── data/
│   ├── monthly_mortality_virology_data_ontario_1991_2024.csv
│   │                           # Monthly aggregated input data
│   ├── meta_analysis_par_estimates.csv
│   │                           # PAR estimates for meta-analysis
│   └── DATA_DICTIONARY.md      # Variable descriptions
├── code/
│   ├── 01_analysis.do          # Main Stata analysis
│   ├── 02_meta_analysis.do     # Meta-analysis and Figure 3
│   └── 03_figures.R            # R code for Figures 1 and 2
├── figures/                     # Output figures (generated by code)
│   ├── figure1_mortality_virology.png
│   ├── figure2_attributable_mortality.png
│   └── figure3_forest_plot.png
└── manuscript/                  # Link to published paper
```

## Reproducing the Analysis

### Requirements

**Software:**
- Stata 17 or higher (for regression analysis)
  - Required packages: `punaf`, `metan`, `suest`
- R 4.0 or higher (for figure generation)
  - Required packages: `haven`, `dplyr`, `tidyr`, `ggplot2`, `patchwork`

### Step 1: Run Stata Analysis

```stata
* Navigate to repository directory
cd "path/to/respiratory-virus-mortality-ontario"

* Run primary analysis
do code/01_analysis.do

* This will:
* - Load data from data/ folder
* - Run negative binomial models (with/without Fourier adjustment)
* - Calculate population attributable fractions
* - Perform Wald tests for FFT sensitivity
* - Generate full dataset with predictions for figures

* Run meta-analysis
do code/02_meta_analysis.do

* This will:
* - Assess heterogeneity by time period and FFT method
* - Generate Figure 3 (forest plot)
```

### Step 2: Generate Figures in R

```r
# Navigate to repository directory
setwd("path/to/respiratory-virus-mortality-ontario")

# Run figure generation script
source("code/03_figures.R")

# This will:
# - Load the full analysis dataset (output from Stata)
# - Generate Figure 1 (mortality and virology surveillance)
# - Generate Figure 2 (attributable mortality time series)
# - Save figures in PNG and TIFF formats
```

### Expected Runtime

- Stata analysis: ~5-10 minutes
- R figure generation: ~1-2 minutes

## Data Sources

### Mortality Data
- **Ontario Deaths Registry** (1994-2024): Monthly death counts, Ontario Ministry of Health
- **Statistics Canada** (1991-1993): Table 13-10-0392-01, Deaths and mortality rates by month

### Virological Surveillance
- **FluWatch** (1993-2024): Influenza A, B, and RSV percent positivity from sentinel laboratories
  - Source: Public Health Agency of Canada
  - URL: https://www.canada.ca/en/public-health/services/diseases/flu-influenza/influenza-surveillance.html

### SARS-CoV-2 Data
- **Adjusted case counts** (March 2020 - August 2022): Test-adjusted case counts from Ontario COVID-19 Science Advisory Table
  - Methodology described in: [Fisman et al., BMC Infectious Diseases, PMID to be added]
- **Percent positivity** (September 2022 - March 2024): SARS-CoV-2 percent positivity from FluWatch sentinel surveillance

### Population Data
- Statistics Canada population estimates (annual, linearly interpolated to monthly)

## Methods Summary

**Statistical Approach:**
- Negative binomial regression (to account for overdispersion)
- Population offset (log-transformed)
- Fourier seasonal adjustment (sine and cosine terms)
- Stratification by pre-pandemic vs. pandemic period
- Sensitivity analysis without Fourier adjustment
- Wald tests to assess impact of seasonal adjustment

**Outcome:**
- Monthly all-cause deaths

**Exposures:**
- Influenza A percent positivity
- Influenza B percent positivity  
- RSV percent positivity
- SARS-CoV-2 adjusted cases per 10,000 (2020-2022) or percent positivity (2022-2024)

**Key Innovation:**
- Systematic assessment of how Fourier seasonal adjustment affects respiratory virus mortality estimates
- Particularly important for RSV, where adjustment produces paradoxical negative associations

## Key Findings

1. **Pre-pandemic baseline:** Influenza A accounted for 1.8% of deaths (95% CI 1.4-2.2%)

2. **SARS-CoV-2 dominance:** During the pandemic, SARS-CoV-2 accounted for 6.5% of deaths (95% CI 4.5-8.4%), 3.6-fold higher than pre-pandemic influenza A despite widespread vaccination and antiviral availability

3. **Validation:** Model-estimated COVID-19 deaths (18,052) closely matched reported COVID-19 deaths (18,603), representing 97% concordance

4. **RSV paradox:** 
   - With FFT: PAR -0.45% pre-pandemic, 0.78% pandemic
   - Without FFT: PAR 1.9% both periods
   - Interpretation: Seasonal adjustment may remove true RSV signal

5. **Heterogeneity:** 
   - Influenza A and RSV: High heterogeneity (I² >88%) driven by both time period and FFT method
   - SARS-CoV-2: Low heterogeneity (I² 2.5%) driven only by FFT method

## Data Availability Statement

All data used in this analysis are publicly available or have been aggregated and anonymized. The monthly aggregated dataset is provided in this repository. Individual-level data are subject to data sharing agreements and cannot be publicly released.

## Ethics Statement

All data used in this study were aggregate-level and publicly available. Ethics approval for use of individual-level COVID-19 surveillance data to derive testing-adjusted case counts was previously obtained (University of Toronto Research Ethics Board, Protocol #41690), and aggregated case counts have been made publicly available.

## Authors

David N. Fisman, MD, MPH, FRCPC  
Dalla Lana School of Public Health, University of Toronto

[Additional authors to be added]

## Contact

For questions about the analysis or code:
- David Fisman: david.fisman@utoronto.ca

For issues with code or data in this repository:
- Open an issue on GitHub: https://github.com/fismanda/respiratory-virus-mortality-ontario/issues

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

We acknowledge the Ontario Ministry of Health, Statistics Canada, and the Public Health Agency of Canada for providing the data that made this analysis possible. We thank the Ontario COVID-19 Science Advisory Table for development of testing-adjusted case count methodology.

## Version History

- **v1.0** (December 2025): Initial release with manuscript submission

---

**Last updated:** December 2025
